<!DOCTYPE html>
<html lang="en">
<head>
  <title>Taler's "Toy" Shop</title>
  <link rel="stylesheet" type="text/css" href="style.css">
    <script>
        /*
        @licstart  The following is the entire license notice for the
        JavaScript code in this page.

        Copyright (C) 2015 GNUnet e.V.

        The JavaScript code in this page is free software: you can
        redistribute it and/or modify it under the terms of the GNU
        Lesser General Public License (GNU LGPL) as published by the Free Software
        Foundation, either version 2.1 of the License, or (at your option)
        any later version.  The code is distributed WITHOUT ANY WARRANTY;
        without even the implied warranty of MERCHANTABILITY or FITNESS
        FOR A PARTICULAR PURPOSE.  See the GNU LGPL for more details.

        As additional permission under GNU LGPL version 2.1 section 7, you
        may distribute non-source (e.g., minimized or compacted) forms of
        that code without the copy of the GNU LGPL normally required by
        section 4, provided you include this license notice and a URL
        through which recipients can access the Corresponding Source.

        @licend  The above is the entire license notice
        for the JavaScript code in this page.
        */
    </script>
</head>
<body id="css-zen-garden" onload="signal_me()">
  <div class="supporting" id="welcome" role="main">
    <div class="explanation" id="zen-explanation" role="article">
      <h1>Welcome to the Taler "Toy" Shop</h1>
      <p>This "toy" website provides you with the ability to
        experience using the
        <a href="https://www.taler.net/">GNU Taler</a>
        payment system without using
        valuable currency.  Here, we guide you through the steps
        of installing a Taler wallet, withdrawing Taler coins and
        spending them at a merchant.  For this demonstrator, we
        will be using a "toy" currency, KUDOS.  However, please note that
        Taler is designed to work with ordinary currencies, such
        as Dollars or Euros, not just toy currencies.
      </p>
    </div>
  </div>
  <div class="supporting" id="instructions" role="main">
    <div class="explanation" id="installation" role="article">
      <h2>Step 1: Installing the Taler wallet</h2>
      <p>First, you need to install the Taler wallet browser extension.
         It is currently only available for Firefox.  If you run
         Firefox, simply click <a href="/extension">here</a>
         to download and install the extension.  You will have to
         click on "allow" and "install" dialogs shown by Firefox.
         After that, the Taler logo should appear on the right side
         of your navigation bar.
      </p>
    </div>
    <div class="explanation" id="installation-done" role="article" style="display:none;">
      <h2>Step 1: Installing the Taler wallet</h2>
      <p>Congratulations, you have installed the wallet correctly.
         You can now proceed with the next steps.
      </p>
    </div>
    <div class="explanation" id="wire" role="article" style="display:none;">
      <h2>Step 2: Performing a wire transfer</h2>
      <p>The next step is to transfer currency to the mint to
         obtain Taler coins.  This is typically done using a
         wire transfer.  However, as this is just a demonstrator,
         we will allow you to send the mint KUDOS coins using a simple
         SEPA-like form from the <a href="http://bank.demo.taler.net/" target="_blank">bank</a>
	 (new tab).</p>
      </p>
    </div>
    <div class="explanation" id="payment" role="article" style="display:none;">
      <h2>Step 3: Select project to donate KUDOS to!</h2>
      <p>Now it is time to spend your hard earned KUDOS.
         For your convenience, we integrated a tiny "shop"
         accepting KUDOS right here into this page.</p>
      <p>Please choose a project and the amount of KUDOS you
         wish to donate.</p>
      <form name="tform" action="/checkout.php" method="POST">
        <div class="participation" id="fake-shop">
          <br>
          <input type="radio" name="donation_receiver" value="Taler" checked="true">GNU Taler</input>
          <br>
          <input type="radio" name="donation_receiver" value="Tor">Tor</input>
          <br>
          <input type="radio" name="donation_receiver" value="GNUnet">GNUnet</input>
          <br>
          <select id="taler-donation" name="donation_amount">
            <option value="0.1">0.1 KUDOS</option>
            <option value="1.0">1 KUDOS</option>
            <option value="6.0">5 KUDOS (*)</option>
            <option value="10.0">10 KUDOS</option>
          </select>
          <input type="hidden" name="donation_currency" value="KUDOS"/>
          <input type="submit" name="keyName" value="Donate!"/>
          <br>
          <br>
        </div>
      </form>
      <p>(*) To make it a bit more fun, the 5 KUDOS option
         is deliberately implemented with a fault: the merchant will try to
         make you donate 6 KUDOS instead of the 5 KUDOS you got to see.  But do
         not worry, you will be given the opportunity to review the
         final offer from the merchant in a window secured
         by the Taler extension.  That way, you can spot the
         error before committing to an incorrect contract.</p>
      </p>
    </div>
  </div>
  <script type="text/javascript">
    /* This function is called if/when a Wallet is installed.
       It should enable the parts of the page that only make
       sense after the Wallet has been loaded.
    */
    function wallet_installed_cb(){
	b = document.getElementById("installation");
        b.style.display = 'none';
	b = document.getElementById("installation-done");
        b.style.display = '';
	b = document.getElementById("wire");
        b.style.display = '';
	b = document.getElementById("payment");
        b.style.display = '';
    };

    function wallet_uninstalled_cb(){
	b = document.getElementById("installation");
        b.style.display = '';
	b = document.getElementById("installation-done");
        b.style.display = 'none';
	b = document.getElementById("wire");
        b.style.display = 'none';
	b = document.getElementById("payment");
        b.style.display = 'none';
    };

    /* The merchant signals its taler-friendlyness to the client */
    function signal_me()
    {
      var eve = new Event('taler-checkout-probe');
      document.body.dispatchEvent(eve);
      //alert("signaling");
    };

    function test_without_wallet(){
        wallet_installed_cb();
    }

    document.body.addEventListener("taler-unload", 
                                   wallet_uninstalled_cb, 
                                   false, false);

    /* Set up a listener to be called whenever a Wallet gets installed
       so that the user is led towards the demo's steps progressively */
    document.body.addEventListener("taler-wallet-present", 
                                   wallet_installed_cb, 
                                   false, false);

    /* Setup callback to be called whenever the wallet is loaded/enabled
      while the browser is already on this page */
    document.body.addEventListener("taler-load", 
                                   signal_me, 
                                   false);
  </script>
</body>
</html>
